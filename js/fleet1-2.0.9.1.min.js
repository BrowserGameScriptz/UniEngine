$(document).ready(function(){function a(a){a+="";var b=/(\d+)(\d\d\d)/;while(b.test(a)){a=a.replace(b,"$1"+"."+"$2")}return a}function b(a,b,c,d){$("#galaxy_selector").val(a);$("#system_selector").val(b);$("#select_planet").val(c);$("#type_selector").val(d)}function c(){var a=parseInt($("#ThisGalaxy").val(),10);var b=parseInt($("#ThisSystem").val(),10);var c=parseInt($("#ThisPlanet").val(),10);var d=parseInt($("#galaxy_selector").val(),10);var e=parseInt($("#system_selector").val(),10);var f=parseInt($("#select_planet").val(),10);var g=0;if(d-a!==0){g=Math.abs(d-a)*2e4}else if(e-b!==0){g=Math.abs(e-b)*95+2700}else if(f-c!==0){g=Math.abs(f-c)*5+1e3}else{g=5}return g}function d(){ret=Math.round((35e3/f()*Math.sqrt(c()*10/e())+10)/g());FlightDuration=ret;if(AllowCreateTimeCounters===true){m()}return ret}function e(){return parseInt($("#MaxSpeed").val(),10)}function f(){return parseFloat($(".setSpeed_Current").attr("data-speed"))}function g(){return parseInt($("#SpeedFactor").val(),10)}function h(){var a=0;var b=0;var e;sp=f();dist=c();dur=d();speedfactor=g();for(e=200;e<300;e+=1){ThisConsumption=$("#consumption"+e).val();if(ThisConsumption!==undefined&&ThisConsumption!==""){spd=35e3/(dur*speedfactor-10)*Math.sqrt(dist*10/parseInt($("#speed"+e).val(),10));b=parseInt(ThisConsumption,10);a+=b*dist/35e3*(spd/10+1)*(spd/10+1)}}a=Math.round(a)+1;return a}function i(){return parseInt($("#Storage").val(),10)-h()}function j(){return parseInt($("#FuelStorage").val(),10)}function k(){return parseInt($("#PlanetDeuterium").val(),10)}function l(){$("#distance").html(a(c()));var b=d();var e=Math.floor(b/3600);b-=e*3600;var f=Math.floor(b/60);b-=f*60;if(f<10){f="0"+f}if(b<10){b="0"+b}if(e<10){e="0"+e}$("#duration").html(e+":"+f+":"+b+" h");var g=i();var l=h();var m=j();if(m>=l){g+=l}else{g+=m}var n=k();var o="";var p="";if(g>=0){if(n>=l){o='<b class="lime">'+a(l)+"</b>"}else{o='<b class="red">'+a(l)+"</b>"}p='<b class="lime">'+a(g)+"</b>"}else{if(n>=l){o='<b class="orange">'+a(l)+"</b>"}else{o='<b class="red">'+a(l)+"</b>"}p='<b class="red">'+a(g)+"</b>"}$("#consumption").html(o);$("#storageShow").html(p)}function m(){var a=(new Date).getTime()+ServerClientDifference;var b=new Date(a);var c=new Date(b.getTime());var d=new Date(b.getTime()+FlightDuration*1e3);var e=new Date(b.getTime()+FlightDuration*2*1e3);var f=c.getFullYear().toString().substr(2,2);var g=c.getMonth();var h=c.getDate();var i=c.getHours();var j=c.getMinutes();var k=c.getSeconds();if(f<10){if(f===0){f="00"}else{f="0"+f}}if(g<10){g="0"+g}if(h<10){h="0"+h}if(i<10){if(i===0){i="00"}else{i="0"+i}}if(j<10){if(j===0){j="00"}else{j="0"+j}}if(k<10){if(k===0){k="00"}else{k="0"+k}}var l=d.getFullYear().toString().substr(2,2);var m=d.getMonth();var n=d.getDate();var o=d.getHours();var p=d.getMinutes();var q=d.getSeconds();if(l<10){if(l===0){l="00"}else{l="0"+l}}if(m<10){m="0"+m}if(n<10){n="0"+n}if(o<10){if(o===0){o="00"}else{o="0"+o}}if(p<10){if(p===0){p="00"}else{p="0"+p}}if(q<10){if(q===0){q="00"}else{q="0"+q}}var r=e.getFullYear().toString().substr(2,2);var s=e.getMonth();var t=e.getDate();var u=e.getHours();var v=e.getMinutes();var w=e.getSeconds();if(r<10){if(r===0){r="00"}else{r="0"+r}}if(s<10){s="0"+s}if(t<10){t="0"+t}if(u<10){if(u===0){u="00"}else{u="0"+u}}if(v<10){if(v===0){v="00"}else{v="0"+v}}if(w<10){if(w===0){w="00"}else{w="0"+w}}$("#curr_time").html(i+":"+j+":"+k+" - "+h+"."+g+"."+f);$("#reach_time").html(o+":"+p+":"+q+" - "+n+"."+m+"."+l);$("#comeback_time").html(u+":"+v+":"+w+" - "+t+"."+s+"."+r)}$.fn.notEmptyVal=function(a){if(!!a){if($(this).val()!=""&&$(this).val()>=0){return true}else{return false}}else{if($(this).val()!=""&&$(this).val()>0){return true}else{return false}}};$.fn.notEmptyData=function(a){if($(this).data(a)!=""&&$(this).data(a)>0){return true}else{return false}};setInterval(m,250);$("th:not(.FBlock, .inv), .updateInfo").addClass("pad2");$(".updateInfo:not(.fastLink, select, .setSpeed)").keyup(function(){if($(this).notEmptyVal(true)){TName=$(this).attr("name");if(TName=="galaxy"||TName=="system"||TName=="planet"){if($(this).val()<1){$(this).val(1)}else if($(this).val()>maxIs[TName]){$(this).val(maxIs[TName])}}l()}}).change(function(){$(this).keyup()}).focus(function(){if($(this).notEmptyVal()){$(this).data("last_val",$(this).val());$(this).val("")}}).blur(function(){if(!$(this).notEmptyVal()){if($(this).notEmptyData("last_val")){$(this).val($(this).data("last_val"));$(this).data("last_val","")}}});$("select.updateInfo:not(.fastLink)").keyup(function(){l()}).change(function(){$(this).keyup()});$(".setSpeed").click(function(){$('input[name="speed"]').val($(this).attr("data-speed"));$(".setSpeed_Selected").removeClass("setSpeed_Selected");$(this).addClass("setSpeed_Selected");l();return false}).hover(function(){if($('input[name="galaxy"]').val()==""||$('input[name="system"]').val()==""||$('input[name="planet"]').val()==""){return}$(".setSpeed_Current").removeClass("setSpeed_Current");$(this).addClass("setSpeed_Current");l()},function(){if($('input[name="galaxy"]').val()==""||$('input[name="system"]').val()==""||$('input[name="planet"]').val()==""){return}$(this).removeClass("setSpeed_Current");$(".setSpeed_Selected").addClass("setSpeed_Current");l()});$(".fastLink").keyup(function(){if($(this).val()!=="-"){var a=$(this).val().split(",");b(a[0],a[1],a[2],a[3]);l()}var c=$(this).attr("id").substr(6);if(c=="1"){c=2}else{c=1}$("#fl_sel"+c).val("-").attr("selected",true)}).change(function(){$(this).keyup()});$("[name=galaxy]").tipTip({delay:0,edgeOffset:8,content:JSLang["fl1_targetGalaxy"]});$("[name=system]").tipTip({delay:0,edgeOffset:8,content:JSLang["fl1_targetSystem"]});$("[name=planet]").tipTip({delay:0,edgeOffset:8,content:JSLang["fl1_targetPlanet"]});$("#goBack").click(function(){$("#thisForm").attr("action","fleet.php").prepend('<input type="hidden" name="gobackUsed" value="1"/>').submit()});$("#thisForm").submit(function(){if(!$("#galaxy_selector").notEmptyVal()){if($("#galaxy_selector").notEmptyData("last_val")){$("#galaxy_selector").val($("#galaxy_selector").data("last_val"));$("#galaxy_selector").data("last_val","")}}if(!$("#system_selector").notEmptyVal()){if($("#system_selector").notEmptyData("last_val")){$("#system_selector").val($("#system_selector").data("last_val"));$("#system_selector").data("last_val","")}}if(!$("#select_planet").notEmptyVal()){if($("#select_planet").notEmptyData("last_val")){$("#select_planet").val($("#select_planet").data("last_val"));$("#select_planet").data("last_val","")}}});l()})