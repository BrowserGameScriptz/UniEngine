$(document).ready(function(){function a(a){a+="";var b=/(\d+)(\d\d\d)/;while(b.test(a)){a=a.replace(b,"$1"+"."+"$2")}return a}function b(a){a+="";a=a.replace(/[^0-9]/g,"");return a}function c(){var a=(new Date).getTime()+ServerClientDifference;var b=new Date(a);var c=new Date(b.getTime()+FlightDurationTarget*1e3);var d=new Date(b.getTime()+(FlightDurationTarget+FlightDurationGoback)*1e3);var e=c.getFullYear().toString().substr(2,2);var f=c.getMonth();var g=c.getDate();var h=c.getHours();var i=c.getMinutes();var j=c.getSeconds();if(e<10){if(e===0){e="00"}else{e="0"+e}}if(f<10){f="0"+f}if(g<10){g="0"+g}if(h<10){if(h===0){h="00"}else{h="0"+h}}if(i<10){if(i===0){i="00"}else{i="0"+i}}if(j<10){if(j===0){j="00"}else{j="0"+j}}var k=d.getFullYear().toString().substr(2,2);var l=d.getMonth();var m=d.getDate();var n=d.getHours();var o=d.getMinutes();var p=d.getSeconds();if(k<10){if(k===0){k="00"}else{k="0"+k}}if(l<10){l="0"+l}if(m<10){m="0"+m}if(n<10){if(n===0){n="00"}else{n="0"+n}}if(o<10){if(o===0){o="00"}else{o="0"+o}}if(p<10){if(p===0){p="00"}else{p="0"+p}}$("#ReachTime").html(h+":"+i+":"+j+" - "+g+"."+f+"."+e);$("#BackTime").html(n+":"+o+":"+p+" - "+m+"."+l+"."+k)}$.fn.notEmptyVal=function(a,c){ThisVal=$(this).val();if(!!c){ThisVal=b(ThisVal)}if(!!a){if(ThisVal!=""&&ThisVal>=0){return true}else{return false}}else{if(ThisVal!=""&&ThisVal>0){return true}else{return false}}};$.fn.notEmptyData=function(a,c,d){ThisVal=$(this).data(a);if(!!d){ThisVal=b(ThisVal)}if(!!c){if(ThisVal!=""&&ThisVal>=0){return true}else{return false}}else{if(ThisVal!=""&&ThisVal>0){return true}else{return false}}};$.fn.prettyInputBox=function(b){return this.each(function(){if(AllowPrettyInputBox!==undefined&&AllowPrettyInputBox===true||b!==undefined&&b===true){Value=$(this).val();if(Value.indexOf(".")!==-1){Value=Value.replace(/\./g,"")}Value=a(Value);$(this).val(Value)}})};$.fn.setStorageShow=function(a){var b="orange";var c="lime";var d="red";if(a>0){b="lime";c="orange"}else if(a<0){b="red";d="orange"}var e=$("#FreeStorageShow");$("#FreeStorageShow").val(a).prettyInputBox().html($("#FreeStorageShow").val());if(e.hasClass(c)){$("#FreeStorageShow").removeClass(c)}else if(e.hasClass(d)){$("#FreeStorageShow").removeClass(d)}if(!e.hasClass(b)){$("#FreeStorageShow").addClass(b)}};setInterval(c,250);$("[id^=setMax]:not(#setMaxAll)").click(function(){SetMaxNow=true;var a='[name="resource'+$(this).attr("id").substr(6)+'"]';$(a).val($(a).val()+1).change();SetMaxNow=false;return false});$("[id^=setZero]:not(#setZeroAll)").click(function(){var a='[name="resource'+$(this).attr("id").substr(7)+'"]';$(a).val("0").change();return false});$("#setMaxAll").click(function(){for(var a in ResSortArrayAll){$("#setMax"+ResSortArrayAll[a]).click()}});$("#setZeroAll").click(function(){for(var a in ResSortArrayAll){$("#setZero"+ResSortArrayAll[a]).click()}});$('[name^="resource"]').change(function(){var a=$(this).attr("name").substr(8);var c=$(this).data("lastVal");var d=parseInt(b($(this).val()),10);if(c===undefined||isNaN(c)||c<0){c=0}if(isNaN(d)||d<0){d=0}if(d!=c||QuantumGateOptionModif){var e=parseInt($("#PlanetResource"+a).val(),10);if(a==3){var f=parseInt($("#Consumption").val(),10);if($("#usequantumgate").is(":checked")){var g=$('[name="mission"]:checked').val();if(g!==undefined){if(QuantumGateDeuteriumUse[g]=="1"){f/=2;f=Math.ceil(f)}else if(QuantumGateDeuteriumUse[g]=="2"){f=0}}}e-=f;if(e<0){e=0}}if(d>e||SetMaxNow){d=e}var h=parseInt($("#FreeStorage").val(),10);var i=d-c;if(i<0){h-=i}else{if(i>h){d-=i-h;h=0}else if(i==h){h=0}else{h-=i}if(d<0){h+=d;d=0;LastStorageLowerTh0=true}}$(this).val(d).prettyInputBox().data("lastVal",d);$("#FreeStorage").val(h).setStorageShow(h)}else{if($(this).val()!=b($(this).val())){$(this).val(d).prettyInputBox()}}}).keyup(function(){$(this).change()}).focus(function(){if(!$(this).notEmptyVal(false,true)){$(this).val("")}}).blur(function(){if(!$(this).notEmptyVal(true,true)){$(this).val("0")}});$(".mSelect").change(function(){var b=QuantumGateDeuteriumUse[$(".mSelect:checked").val()];var c=0;var d=0;if(b!==undefined){switch(b){case 0:d=0;c=0;FlyTimeTargetModif=0;FlyTimeBackModif=0;break;case 1:d=parseInt($("#Consumption").val(),10);if(isNaN(d)){d=0}else{d/=2;d=Math.ceil(d)}c=d;d-=parseInt($("#FuelStorageReduceH").val(),10);FlyTimeTargetModif=1;FlyTimeBackModif=0;break;case 2:d=parseInt($("#Consumption").val(),10);if(isNaN(d)){d=0}c=d;d-=parseInt($("#FuelStorageReduce").val(),10);FlyTimeTargetModif=1;FlyTimeBackModif=1;break;default:d=0;c=0;FlyTimeTargetModif=0;FlyTimeBackModif=0;break}var e=$("#FuelUse").data("ConsuptionModif_Old");var f=$("#FuelUse").data("ConsuptionVar_Now");if(e===undefined){e=0}if(f===undefined){f=parseInt($("#Consumption").val(),10)}if(!$("#usequantumgate").is(":checked")){c=0}var g=c-e;if(g!==0){f-=g;$("#FuelUse").html(a(f));$("#FuelUse").data("ConsuptionModif_Old",c);$("#FuelUse").data("ConsuptionVar_Now",f)}var h=false;var i=$("#FreeStorage").data("StorageModif_Old");if(i===undefined){i=0}if(!$("#usequantumgate").is(":checked")){d=0}var j=d-i;if(j!==0){var k=parseInt($("#FreeStorage").val(),10)+j;$("#FreeStorage").data("StorageModif_Old",d);h=true}if(h){$("#FreeStorage").val(k).setStorageShow(k);QuantumGateOptionModif=true;$("[name=resource3]").change();if(LastStorageLowerTh0){LastStorageLowerTh0=false;var l="1";var m="2";if(ResSortArrayNoDeu[0]=="met"){l="2";m="1"}$("[name=resource"+l+"]").change();if(LastStorageLowerTh0){LastStorageLowerTh0=false;$("[name=resource"+m+"]").change();LastStorageLowerTh0=false}}QuantumGateOptionModif=false}if(!$("#usequantumgate").is(":checked")){FlyTimeBackModif=0;FlyTimeTargetModif=0}if(FlyTimeTargetModif==1){FlightDurationTarget=1}else{FlightDurationTarget=FlightDuration}if(FlyTimeBackModif==1){FlightDurationGoback=1}else{FlightDurationGoback=FlightDuration}var n=FlightDurationTarget;var o=Math.floor(n/3600);n-=o*3600;var p=Math.floor(n/60);n-=p*60;if(p<10){p="0"+p}if(n<10){n="0"+n}if(o<10){o="0"+o}var q=o+":"+p+":"+n;if(FlyTimeTargetModif==1&&FlyTimeBackModif==0){n=FlightDurationGoback;o=Math.floor(n/3600);n-=o*3600;p=Math.floor(n/60);n-=p*60;if(p<10){p="0"+p}if(n<10){n="0"+n}if(o<10){o="0"+o}q+=" h<br/>"+o+":"+p+":"+n;$(".flyTimeInfo").show();$(".flyTimeNoInfo").hide()}else{$(".flyTimeInfo").hide();$(".flyTimeNoInfo").show()}$("#FlightTimeShow").html(q)}});$("#usequantumgate").click(function(){if(NeedQuantumGate=="1"){if($(this).is(":checked")){$("#noDeutInfo").hide()}else{$("#noDeutInfo").show()}}$(".mSelect").change()});if(NeedQuantumGate!="1"||NeedQuantumGate=="1"&&$("#usequantumgate").is(":checked")==true){$("#noDeutInfo").hide()}$(".flyTimeInfo").tipTip({delay:0,maxWidth:250,edgeOffset:8,content:JSLang["fl2_FlyTimeInfo"]});$(".planet").tipTip({delay:0,edgeOffset:8,content:JSLang["fl_coordplanet"]});$(".moon").tipTip({delay:0,edgeOffset:8,content:JSLang["fl_coordmoon"]});$(".debris").tipTip({delay:0,edgeOffset:8,content:JSLang["fl_coorddebris"]});$(".flyTimeInfo").hide();$("th:not(.FBlock, .inv, .QuantumInfo), #gTb td").addClass("pad2");$("#InfoTable").find("th:not(.nfoInv)").addClass("nfoTH");$("#InfoTable").find("th.inv").addClass("nfoInv");$("#goBack").click(function(){$("#thisForm").attr("action","fleet1.php").prepend('<input type="hidden" name="gobackUsed" value="1"/>').submit()});$("#thisForm").submit(function(){if($('[name="gobackUsed"]').length<=0){if(AllyPact_AttackWarn===true){var a=$('[name="mission"]:checked').val();if(a==1||a==2||a==9||a==10){return confirm(JSLang["confirm_allypact_attack"])}}}});if(SetResources===false){if($("#quickres").val()=="1"){$("#setMaxAll").click()}}else{$('[name="resource1"]').val(SetResources["resource1"]).change();$('[name="resource2"]').val(SetResources["resource2"]).change();$('[name="resource3"]').val(SetResources["resource3"]).change()}if(SelectQuantumGate===true){$("#usequantumgate").click();$(".mSelect").change()}})